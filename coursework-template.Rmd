---
title: "Coursework submission for Transport Data Science (TRAN5340M)"
output: github_document
# output:
#   html_document:
#     number_sections: true
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

# Introduction

This template contains information and suggested headings for the TDS module.
Please do not submit coursework that contains this note or any text (other than the headings) from this template.
It is just designed to get you started. You will submit the .Rmd file and the resulting document as your coursework submission.

## RMarkdown

This is an R Markdown file.
You can set the output by changing `output: github_document` to something different, like `output: html_document`.
See here for more info: https://rmarkdown.rstudio.com/lesson-2.html


When you open this file in RStudio and click the **Knit** button all R code chunks are run and a markdown file (.md) suitable for publishing to GitHub is generated.

To ensure the document is reproducible, you should include a code chunk that shows which packages you used, e.g.:

```{r, message=FALSE}
# install.packages("remotes")
remotes::install_github("itsleeds/pct")
remotes::install_github("ropensci/stats19")
library(dplyr)
library(pct)
library(stplanr)
```

You can add references manually or with `[@citation-key]` references linking to a .bib file like this[@lovelace_stplanr_2017].
And this [@fox_data_2018].


## Including Code

You can include R code in the document as follows:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

# Datasets used

You can get zone, OD and even route data for any city in the UK with the following commands.
We got data for the Isle of Wight with the following commands:

```{r, message=FALSE}
library(pct)
region_name = "isle-of-wight"
z = get_pct_zones(region = region_name)
od = get_od()
od_in_zones = od %>% 
  filter(geo_code1 %in% z$geo_code) %>% 
  filter(geo_code2 %in% z$geo_code) 
desire_lines = od2line(od_in_zones, z)
```

# Descriptive analysis

```{r}
plot(desire_lines)
```

```{r}
library(tmap)
```


# Route analysis

# Additional datasets

You could get data from OpenStreetMap with the `osmdata` package.

```{r}
library(osmdata)
osm_data = opq("isle of wight") %>% 
  add_osm_feature(key = "highway", value = "primary") %>% 
  osmdata_sf()
```


You could get road casualty data with the `stats19` pakckage, as shown below.

```{r}
crashes = stats19::get_stats19(year = 2018, output_format = "sf") %>% 
  sf::st_transform(crs = sf::st_crs(z))

crashes_in_region = crashes[z, ]
tm_shape(z) +
  tm_fill("car_driver", palette = "Greys") +
  tm_shape(osm_data$osm_lines) +
  tm_lines(col = "maxspeed", lwd = 3) +
  tm_shape(crashes_in_region) +
  tm_dots(size = 1, col = "red")
```


# Policy analysis

Here you could explain how you explored answers to policy questions such as:

- how to make the roads safer?
- how to reduce congestion?
- where to build bike parking?

# Discussion

Include here limitations and ideas for further research.

# Conclusion

What are the main things we have learned from this project?

# References

